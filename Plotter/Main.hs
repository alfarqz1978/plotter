-- to do:
--
-- * change L, R to U, D
-- * make model more precise by calculating exact point on the spool where
--   string unravels
-- * split into multiple files: model, driver, parser
-- * why is driver so ugly and long?
-- * rename lineS to someting sensible but not clashing with Prelude

module Plotter.Main (main) where

import Graphics.Gloss
import Plotter.Driver

data Step = L | R | N deriving (Eq, Show)
data Command = PenDown | PenUp | Move (Step, Step) deriving (Show)
data Pen = Up | Down deriving (Show)
data HPGLCommand = PD | PU | MV (Float, Float)

data Spool = Spool { point :: Point
                   , string :: Float
                   , angle :: Float
                   , pullSign :: Float
                   } deriving (Show)

data Plotter = Plotter { left :: Spool
                       , right :: Spool
                       , marker :: Point
                       , lineS :: [(Point, Point)]
                       , commands :: [Command]
                       , pen :: Pen
                       } deriving (Show)


leftSpool = Spool { point = (-250, 200)
                  , string = distance (-250, 200) (0, 0)
                  , angle = 0
                  , pullSign = -1}

rightSpool = Spool { point = (250, 200)
                   , string = distance (250, 200) (0, 0)
                   , angle = 0
                   , pullSign = 1}

-- nextPlotter to initialize points
plotter = nextPlotter Plotter { left = leftSpool
                              , right = rightSpool
                              , marker = (0, 0)
                              , lineS = []
                              , commands = commandSequence
                              , pen = Up }

nextPlotter :: Plotter -> Plotter
nextPlotter plotter@(Plotter left' right' marker' lineS' [] pen) = plotter

nextPlotter plotter@(Plotter left' right' marker' lineS' (command:coms) pen') =
  Plotter { left = newLeft
          , right = newRight
          , marker = newMarker
          , lineS = newLines
          , commands = coms
          , pen = newPen }
  where
    newLeft = nextSpool left' leftCommand
    newRight = nextSpool right' rightCommand
    leftCommand = case command of
      Move (l, r) -> l
      _ -> N
    rightCommand = case command of
      Move (l, r) -> r
      _ -> N
    newMarker = intersectCircles (point newLeft) (string newLeft)
                                 (point newRight) (string newRight)
    newLines = case pen' of
      Up -> lineS'
      Down -> (newMarker, marker'):lineS'
    newPen = case command of
      PenDown -> Down
      PenUp -> Up
      _ -> pen'


transformPlotter :: Float -> Plotter -> Plotter
transformPlotter time plotter = transformPlotter' plotter completeStepCount
  where
    transformPlotter' plotter 0 = plotter
    transformPlotter' plotter n = transformPlotter' (nextPlotter plotter) (n-1)
    (completeStepCount, _) = splitTime time

nextSpool :: Spool -> Step -> Spool
nextSpool spool@(Spool point' string' angle' pullSign') step =
  Spool { point = point'
        , string = string' + pullPerStep * pullSign' * rotSign
        , angle = angle' + degreesPerStep * rotSign
        , pullSign = pullSign' }
  where
    rotSign = rotationSign step

canvasSize = (300, 200)
timePerStep = 0.0002 :: Float
degreesPerStep = 0.1 :: Float
spoolCircumference = 2 * pi * spoolRadius
pullPerStep = (degreesPerStep / 360) * spoolCircumference
spoolRadius = 10 :: Float

main :: IO ()
main
 =  animate (InWindow "Plotter" (800, 600) (5, 5))
                black
    frame

frame :: Float -> Picture
frame timeS = Scale 1.2 1.2
  $ plotterPic (transformPlotter timeS plotter)

plotterPic :: Plotter -> Picture
plotterPic plotter = Pictures [ spoolPic (left plotter)
                              , spoolPic (right plotter)
                              , canvasPic
                              , stringPic (point $ left plotter) (marker plotter)
                              , stringPic (point $ right plotter) (marker plotter)
                              , linePic (lineS plotter) ]

linePic :: [(Point, Point)] -> Picture
linePic lines = Pictures $ map renderLine lines
  where
    renderLine (start, end) = Color white (line [start, end])

spoolPic :: Spool -> Picture
spoolPic spool = trans (point spool) (Rotate (angle spool) pic)
  where
    pic = Pictures [ Color white (circle spoolRadius)
                   , Color white (line [(0, 0), (spoolRadius, 0)]) ]

stringPic :: Point -> Point -> Picture
stringPic (spoolX, spoolY) end = Color (greyN 0.4) (line [start, end])
  where
    start = (spoolX, spoolY - spoolRadius)

trans :: Point -> Picture -> Picture
trans (x, y) pic = Translate x y pic

canvasPic :: Picture
canvasPic = color (greyN 0.2) (rectangleWire width height)
  where
    width = fst canvasSize
    height = snd canvasSize

splitTime :: Float -> (Int, Float)
splitTime time = (completeStepCount, remainder)
  where
    steps = time / timePerStep
    completeStepCount = floor steps
    remainder = (time - (fromIntegral completeStepCount) * timePerStep) / timePerStep

---- returns only bottom result as our strings are pulled by gravity
intersectCircles :: Point -> Float -> Point -> Float -> Point
intersectCircles (x0, y0) r0 (x1, y1) r1 = (x3, y3)
  where
    x3 = x2 + h * (y1 - y0) / d
    y3 = y2 - h * (x1 - x0) / d
    d = distance (x0, y0) (x1, y1)
    a = (r0^2 - r1^2 + d^2) / (2*d)
    h = sqrt (r0^2 - a^2)
    x2 = x0 + a * (x1 - x0) / d
    y2 = y0 + a * (y1 - y0) / d

distance :: Point -> Point -> Float
distance (x1, y1) (x2, y2) = sqrt (x'*x' + y'*y')
    where
        x' = x1 - x2
        y' = y1 - y2

rotationSign :: Step -> Float
rotationSign L = -1
rotationSign R = 1
rotationSign N = 0

lengthChange :: Point -> Point -> Point -> Point -> (Float, Float)
lengthChange leftPoint rightPoint start target = (newLeft - oldLeft, newRight - oldRight)
  where
    oldLeft = distance leftPoint start
    oldRight = distance rightPoint start
    newLeft = distance leftPoint target
    newRight = distance rightPoint target

calculateSteps :: Point -> Point -> Point -> Point -> [(Step, Step)]
calculateSteps leftPoint rightPoint start target =
  toSteps $ lengthChange leftPoint rightPoint start target

toInts :: (Float, Float) -> [(Int, Int)]
toInts (leftDelta, rightDelta) = if leftSteps > rightSteps
  then map (\i -> (i, r i)) [1..leftSteps]
  else map (\i -> (r i, i)) [1..rightSteps]
  where
    leftSteps = abs $ round $ leftDelta / pullPerStep
    rightSteps = abs $ round $ rightDelta / pullPerStep
    minimum = min leftSteps rightSteps
    maximum = max leftSteps rightSteps
    x = (fromIntegral maximum) / (fromIntegral minimum)
    r i = round (fromIntegral i / x)

intsToSteps :: (Step, Step) -> [(Int, Int)] -> [(Step, Step)]
intsToSteps (leftStep, rightStep) ints = zip (stepify leftStep left) (stepify rightStep right)
  where
    left = map fst ints
    right = map snd ints

stepify :: Step -> [Int] -> [Step]
stepify step [] = []
stepify step (x:xs) = if x == 0
  then (N:stepify' 0 xs)
  else stepify' (-1) (x:xs)
  where
    stepify' prev [] = []
    stepify' prev (x:xs) = (s:stepify' x xs)
      where
        s = if prev == x
          then N
          else step

toSteps :: (Float, Float) -> [(Step, Step)]
toSteps (leftDelta, rightDelta) = intsToSteps steps ints
  where
    steps = (leftRotation leftDelta, rightRotation rightDelta)
    ints = toInts (leftDelta, rightDelta)

leftRotation :: Float -> Step
leftRotation 0 = N
leftRotation lengthChange = if lengthChange > 0
  then L
  else R

rightRotation :: Float -> Step
rightRotation 0 = N
rightRotation lengthChange = if lengthChange > 0
  then R
  else L


hpgl = [ PD
        , PD
        , MV (24.24000000000001, -81.54)
        , MV (24.150000000000006, -83.25)
        , MV (24.060000000000002, -84.96000000000001)
        , MV (23.909999999999997, -86.66999999999999)
        , MV (23.72999999999999, -88.35)
        , MV (23.49000000000001, -90.06)
        , MV (23.22, -91.74)
        , MV (22.890000000000015, -93.42)
        , MV (22.560000000000002, -95.1)
        , MV (22.169999999999987, -96.75)
        , MV (21.72, -98.43)
        , MV (21.23999999999998, -100.05)
        , MV (20.730000000000018, -101.69999999999999)
        , MV (20.160000000000025, -103.32)
        , MV (19.590000000000003, -104.91)
        , MV (18.930000000000007, -106.5)
        , MV (18.269999999999982, -108.06)
        , MV (17.55000000000001, -109.62)
        , MV (16.80000000000001, -111.15)
        , MV (16.02000000000001, -112.68)
        , MV (15.180000000000007, -114.18)
        , MV (14.339999999999975, -115.65)
        , MV (13.439999999999998, -117.12)
        , MV (12.509999999999991, -118.56)
        , MV (11.52000000000001, -119.97)
        , MV (10.530000000000001, -121.35)
        , MV (9.47999999999999, -122.7)
        , MV (8.430000000000007, -124.05)
        , MV (7.319999999999993, -125.34)
        , MV (6.179999999999978, -126.63)
        , MV (5.0400000000000205, -127.89)
        , MV (3.8400000000000034, -129.12)
        , MV (2.6100000000000136, -130.32)
        , MV (1.3499999999999943, -131.46)
        , MV (0.09000000000000341, -132.6)
        , MV (-1.2299999999999898, -133.71)
        , MV (-2.5800000000000125, -134.76)
        , MV (-3.930000000000007, -135.81)
        , MV (-5.310000000000002, -136.8)
        , MV (-6.719999999999999, -137.79)
        , MV (-8.159999999999997, -138.72)
        , MV (-9.629999999999995, -139.62)
        , MV (-11.099999999999994, -140.46)
        , MV (-12.599999999999994, -141.3)
        , MV (-14.099999999999994, -142.08)
        , MV (-15.659999999999997, -142.83)
        , MV (-17.189999999999998, -143.55)
        , MV (-18.78, -144.21)
        , MV (-20.370000000000005, -144.84)
        , MV (-21.960000000000008, -145.44)
        , MV (-23.58, -146.01)
        , MV (-25.230000000000004, -146.52)
        , MV (-26.85000000000001, -147.0)
        , MV (-28.499999999999986, -147.42)
        , MV (-30.180000000000007, -147.84)
        , MV (-31.86, -148.17)
        , MV (-33.540000000000006, -148.5)
        , MV (-35.22, -148.77)
        , MV (-36.92999999999999, -149.01)
        , MV (-38.61, -149.19)
        , MV (-40.32000000000001, -149.34)
        , MV (-42.03, -149.43)
        , MV (-43.739999999999995, -149.49)
        , MV (-45.45, -149.52)
        , MV (-47.16, -149.49)
        , MV (-48.86999999999999, -149.43)
        , MV (-50.58000000000001, -149.34)
        , MV (-52.290000000000006, -149.19)
        , MV (-53.97, -149.01)
        , MV (-55.67999999999999, -148.77)
        , MV (-57.36, -148.5)
        , MV (-59.03999999999999, -148.17)
        , MV (-60.72000000000001, -147.84)
        , MV (-62.36999999999999, -147.42)
        , MV (-64.05000000000001, -147.0)
        , MV (-65.67, -146.52)
        , MV (-67.32, -146.01)
        , MV (-68.94, -145.44)
        , MV (-70.52999999999999, -144.84)
        , MV (-72.12, -144.21)
        , MV (-73.67999999999999, -143.55)
        , MV (-75.24, -142.83)
        , MV (-76.77, -142.08)
        , MV (-78.3, -141.3)
        , MV (-79.8, -140.46)
        , MV (-81.27, -139.62)
        , MV (-82.74, -138.72)
        , MV (-84.17999999999999, -137.79)
        , MV (-85.59, -136.8)
        , MV (-86.97, -135.81)
        , MV (-88.32, -134.76)
        , MV (-89.67, -133.71)
        , MV (-90.96000000000001, -132.6)
        , MV (-92.25, -131.46)
        , MV (-93.50999999999999, -130.32)
        , MV (-94.74000000000001, -129.12)
        , MV (-95.94, -127.89)
        , MV (-97.08, -126.63)
        , MV (-98.22, -125.34)
        , MV (-99.33, -124.05)
        , MV (-100.38, -122.7)
        , MV (-101.43, -121.35)
        , MV (-102.42, -119.97)
        , MV (-103.41, -118.56)
        , MV (-104.34, -117.12)
        , MV (-105.24000000000001, -115.65)
        , MV (-106.08, -114.18)
        , MV (-106.92, -112.68)
        , MV (-107.7, -111.15)
        , MV (-108.44999999999999, -109.62)
        , MV (-109.17, -108.06)
        , MV (-109.83000000000001, -106.5)
        , MV (-110.46000000000001, -104.91)
        , MV (-111.06, -103.32)
        , MV (-111.63, -101.69999999999999)
        , MV (-112.14, -100.05)
        , MV (-112.62, -98.43)
        , MV (-113.03999999999999, -96.75)
        , MV (-113.46000000000001, -95.1)
        , MV (-113.78999999999999, -93.42)
        , MV (-114.12, -91.74)
        , MV (-114.39, -90.06)
        , MV (-114.63, -88.35)
        , MV (-114.81, -86.66999999999999)
        , MV (-114.96000000000001, -84.96000000000001)
        , MV (-115.05, -83.25)
        , MV (-115.11, -81.54)
        , MV (-115.14, -79.83)
        , MV (-115.11, -78.12)
        , MV (-115.05, -76.41)
        , MV (-114.96000000000001, -74.7)
        , MV (-114.81, -72.99000000000001)
        , MV (-114.63, -71.31)
        , MV (-114.39, -69.6)
        , MV (-114.12, -67.92)
        , MV (-113.78999999999999, -66.24)
        , MV (-113.46000000000001, -64.56)
        , MV (-113.03999999999999, -62.91)
        , MV (-112.62, -61.230000000000004)
        , MV (-112.14, -59.61)
        , MV (-111.63, -57.959999999999994)
        , MV (-111.06, -56.34)
        , MV (-110.46000000000001, -54.75)
        , MV (-109.83000000000001, -53.16000000000001)
        , MV (-109.17, -51.599999999999994)
        , MV (-108.44999999999999, -50.040000000000006)
        , MV (-107.7, -48.480000000000004)
        , MV (-106.92, -46.980000000000004)
        , MV (-106.08, -45.480000000000004)
        , MV (-105.24000000000001, -44.010000000000005)
        , MV (-104.34, -42.53999999999999)
        , MV (-103.41, -41.10000000000001)
        , MV (-102.42, -39.69)
        , MV (-101.43, -38.30999999999999)
        , MV (-100.38, -36.959999999999994)
        , MV (-99.33, -35.610000000000014)
        , MV (-98.22, -34.32000000000001)
        , MV (-97.08, -33.02999999999999)
        , MV (-95.94, -31.769999999999996)
        , MV (-94.74000000000001, -30.540000000000006)
        , MV (-93.50999999999999, -29.340000000000003)
        , MV (-92.25, -28.19999999999999)
        , MV (-90.96000000000001, -27.060000000000002)
        , MV (-89.67, -25.950000000000003)
        , MV (-88.32, -24.900000000000006)
        , MV (-86.97, -23.85000000000001)
        , MV (-85.59, -22.86)
        , MV (-84.17999999999999, -21.870000000000005)
        , MV (-82.74, -20.939999999999998)
        , MV (-81.27, -20.04000000000002)
        , MV (-79.8, -19.19999999999999)
        , MV (-78.3, -18.359999999999985)
        , MV (-76.77, -17.579999999999984)
        , MV (-75.24, -16.829999999999984)
        , MV (-73.67999999999999, -16.110000000000014)
        , MV (-72.12, -15.449999999999989)
        , MV (-70.52999999999999, -14.789999999999992)
        , MV (-68.94, -14.219999999999999)
        , MV (-67.32, -13.650000000000006)
        , MV (-65.67, -13.140000000000015)
        , MV (-64.05000000000001, -12.659999999999997)
        , MV (-62.36999999999999, -12.210000000000008)
        , MV (-60.72000000000001, -11.819999999999993)
        , MV (-59.03999999999999, -11.460000000000008)
        , MV (-57.36, -11.159999999999997)
        , MV (-55.67999999999999, -10.889999999999986)
        , MV (-53.97, -10.650000000000006)
        , MV (-52.290000000000006, -10.469999999999999)
        , MV (-50.58000000000001, -10.319999999999993)
        , MV (-48.86999999999999, -10.230000000000018)
        , MV (-47.16, -10.139999999999986)
        , MV (-45.45, -10.139999999999986)
        , MV (-43.739999999999995, -10.139999999999986)
        , MV (-42.03, -10.230000000000018)
        , MV (-40.32000000000001, -10.319999999999993)
        , MV (-38.61, -10.469999999999999)
        , MV (-36.92999999999999, -10.650000000000006)
        , MV (-35.22, -10.889999999999986)
        , MV (-33.540000000000006, -11.159999999999997)
        , MV (-31.86, -11.460000000000008)
        , MV (-30.180000000000007, -11.819999999999993)
        , MV (-28.499999999999986, -12.210000000000008)
        , MV (-26.85000000000001, -12.659999999999997)
        , MV (-25.230000000000004, -13.140000000000015)
        , MV (-23.58, -13.650000000000006)
        , MV (-21.960000000000008, -14.219999999999999)
        , MV (-20.370000000000005, -14.789999999999992)
        , MV (-18.78, -15.449999999999989)
        , MV (-17.189999999999998, -16.110000000000014)
        , MV (-15.659999999999997, -16.829999999999984)
        , MV (-14.099999999999994, -17.579999999999984)
        , MV (-12.599999999999994, -18.359999999999985)
        , MV (-11.099999999999994, -19.19999999999999)
        , MV (-9.629999999999995, -20.04000000000002)
        , MV (-8.159999999999997, -20.939999999999998)
        , MV (-6.719999999999999, -21.870000000000005)
        , MV (-5.310000000000002, -22.86)
        , MV (-3.930000000000007, -23.85000000000001)
        , MV (-2.5800000000000125, -24.900000000000006)
        , MV (-1.2299999999999898, -25.950000000000003)
        , MV (0.09000000000000341, -27.060000000000002)
        , MV (1.3499999999999943, -28.19999999999999)
        , MV (2.6100000000000136, -29.340000000000003)
        , MV (3.8400000000000034, -30.540000000000006)
        , MV (5.0400000000000205, -31.769999999999996)
        , MV (6.179999999999978, -33.02999999999999)
        , MV (7.319999999999993, -34.32000000000001)
        , MV (8.430000000000007, -35.610000000000014)
        , MV (9.47999999999999, -36.959999999999994)
        , MV (10.530000000000001, -38.30999999999999)
        , MV (11.52000000000001, -39.69)
        , MV (12.509999999999991, -41.10000000000001)
        , MV (13.439999999999998, -42.53999999999999)
        , MV (14.339999999999975, -44.010000000000005)
        , MV (15.180000000000007, -45.480000000000004)
        , MV (16.02000000000001, -46.980000000000004)
        , MV (16.80000000000001, -48.480000000000004)
        , MV (17.55000000000001, -50.040000000000006)
        , MV (18.269999999999982, -51.599999999999994)
        , MV (18.930000000000007, -53.16000000000001)
        , MV (19.590000000000003, -54.75)
        , MV (20.160000000000025, -56.34)
        , MV (20.730000000000018, -57.959999999999994)
        , MV (21.23999999999998, -59.61)
        , MV (21.72, -61.230000000000004)
        , MV (22.169999999999987, -62.91)
        , MV (22.560000000000002, -64.56)
        , MV (22.890000000000015, -66.24)
        , MV (23.22, -67.92)
        , MV (23.49000000000001, -69.6)
        , MV (23.72999999999999, -71.31)
        , MV (23.909999999999997, -72.99000000000001)
        , MV (24.060000000000002, -74.7)
        , MV (24.150000000000006, -76.41)
        , MV (24.24000000000001, -78.12)
        , MV (24.24000000000001, -79.83)
        , PU
        , MV (-50.64, -149.79)
        , PD
        , MV (-53.46000000000001, -149.58)
        , MV (-56.25, -149.25)
        , MV (-59.03999999999999, -148.8)
        , MV (-61.77000000000001, -148.2)
        , MV (-64.50000000000001, -147.51)
        , MV (-67.17, -146.7)
        , MV (-69.81, -145.77)
        , MV (-72.42, -144.75)
        , MV (-75.0, -143.61)
        , MV (-77.52, -142.38)
        , MV (-79.98, -141.03)
        , MV (-82.38000000000001, -139.62)
        , MV (-84.75, -138.09)
        , MV (-87.03, -136.47)
        , MV (-89.25, -134.76)
        , MV (-91.41, -132.96)
        , MV (-93.50999999999999, -131.1)
        , MV (-95.52, -129.15)
        , MV (-97.47, -127.11)
        , MV (-99.33, -125.01)
        , MV (-101.1, -122.85)
        , MV (-102.81, -120.6)
        , MV (-104.4, -118.32)
        , MV (-105.9, -115.94999999999999)
        , MV (-107.31, -113.52000000000001)
        , MV (-108.63, -111.03)
        , MV (-109.83000000000001, -108.50999999999999)
        , MV (-110.94, -105.93)
        , MV (-111.92999999999999, -103.32)
        , MV (-112.8, -100.65)
        , MV (-113.58, -97.92)
        , MV (-114.21000000000001, -95.16)
        , MV (-114.69, -92.85)
        , MV (-115.11, -90.50999999999999)
        , MV (-115.44, -88.17)
        , MV (-115.68, -85.83)
        , MV (-115.83, -83.49)
        , MV (-115.89, -81.12)
        , MV (-115.89, -78.75)
        , MV (-115.8, -76.41)
        , MV (-115.65, -74.04)
        , MV (-115.41, -71.7)
        , MV (-115.08, -69.36)
        , MV (-114.66, -67.05)
        , MV (-114.21000000000001, -64.74)
        , MV (-113.64, -62.43000000000001)
        , MV (-113.00999999999999, -60.18000000000001)
        , MV (-112.32, -57.92999999999999)
        , MV (-111.53999999999999, -55.67999999999999)
        , MV (-110.69999999999999, -53.49000000000001)
        , MV (-109.77000000000001, -51.3)
        , MV (-108.78, -49.17)
        , MV (-107.73, -47.06999999999999)
        , MV (-106.59, -45.0)
        , MV (-105.39, -42.959999999999994)
        , MV (-104.13, -40.980000000000004)
        , MV (-102.81, -39.03)
        , MV (-101.4, -37.14)
        , MV (-99.93, -35.28)
        , MV (-98.4, -33.47999999999999)
        , MV (-96.81, -31.739999999999995)
        , MV (-95.16, -30.060000000000002)
        , MV (-93.45, -28.439999999999998)
        , MV (-91.65, -26.88000000000001)
        , MV (-90.36, -25.769999999999996)
        , MV (-89.03999999999999, -24.689999999999998)
        , MV (-87.69, -23.67)
        , MV (-86.31, -22.650000000000006)
        , MV (-84.9, -21.689999999999998)
        , MV (-83.49, -20.75999999999999)
        , MV (-82.02, -19.859999999999985)
        , MV (-80.58, -19.02000000000001)
        , MV (-79.08, -18.180000000000007)
        , MV (-77.58, -17.400000000000006)
        , MV (-76.05, -16.650000000000006)
        , MV (-74.49000000000001, -15.930000000000007)
        , MV (-72.92999999999999, -15.27000000000001)
        , MV (-71.37, -14.610000000000014)
        , MV (-69.77999999999999, -14.01000000000002)
        , MV (-68.16000000000001, -13.469999999999999)
        , MV (-66.57, -12.930000000000007)
        , MV (-64.91999999999999, -12.449999999999989)
        , MV (-63.30000000000001, -12.0)
        , MV (-61.650000000000006, -11.610000000000014)
        , MV (-59.97000000000001, -11.25)
        , MV (-58.32000000000001, -10.919999999999987)
        , MV (-56.64, -10.650000000000006)
        , MV (-54.959999999999994, -10.409999999999997)
        , MV (-53.25, -10.199999999999989)
        , MV (-51.56999999999999, -10.049999999999983)
        , MV (-49.86, -9.930000000000007)
        , MV (-48.18000000000001, -9.870000000000005)
        , MV (-46.47, -9.840000000000003)
        , MV (-44.760000000000005, -9.840000000000003)
        , MV (-43.05000000000001, -9.900000000000006)
        , MV (-41.370000000000005, -10.019999999999982)
        , MV (-38.67, -10.199999999999989)
        , MV (-36.0, -10.469999999999999)
        , MV (-33.36, -10.860000000000014)
        , MV (-30.72, -11.370000000000005)
        , MV (-28.11, -12.0)
        , MV (-25.560000000000002, -12.719999999999999)
        , MV (-23.00999999999999, -13.530000000000001)
        , MV (-20.49000000000001, -14.460000000000008)
        , MV (-18.03, -15.47999999999999)
        , MV (-15.599999999999994, -16.590000000000003)
        , MV (-13.22999999999999, -17.789999999999992)
        , MV (-10.889999999999986, -19.109999999999985)
        , MV (-8.610000000000014, -20.49000000000001)
        , MV (-6.359999999999985, -21.960000000000008)
        , MV (-4.200000000000017, -23.52000000000001)
        , MV (-2.069999999999993, -25.14)
        , MV (-0.030000000000001137, -26.85000000000001)
        , MV (1.9800000000000182, -28.64999999999999)
        , MV (3.9000000000000057, -30.510000000000005)
        , MV (5.759999999999991, -32.42999999999999)
        , MV (7.530000000000001, -34.44)
        , MV (9.240000000000009, -36.50999999999999)
        , MV (10.860000000000014, -38.61)
        , MV (12.419999999999987, -40.8)
        , MV (13.890000000000015, -43.05000000000001)
        , MV (15.23999999999998, -45.33)
        , MV (16.53, -47.69999999999999)
        , MV (17.700000000000017, -50.099999999999994)
        , MV (18.810000000000002, -52.52999999999999)
        , MV (19.799999999999983, -55.019999999999996)
        , MV (20.669999999999987, -57.57000000000001)
        , MV (21.44999999999999, -60.120000000000005)
        , MV (22.02000000000001, -62.03999999999999)
        , MV (22.5, -63.959999999999994)
        , MV (22.920000000000016, -65.91)
        , MV (23.28, -67.86)
        , MV (23.55000000000001, -69.84)
        , MV (23.79000000000002, -71.82000000000001)
        , MV (23.97, -73.8)
        , MV (24.060000000000002, -75.78)
        , MV (24.120000000000005, -77.76)
        , MV (24.150000000000006, -79.77)
        , MV (24.120000000000005, -81.75)
        , MV (24.029999999999973, -83.72999999999999)
        , MV (23.909999999999997, -85.74)
        , MV (23.76000000000002, -87.72)
        , MV (23.55000000000001, -89.67)
        , MV (23.340000000000003, -91.65)
        , MV (22.890000000000015, -94.14)
        , MV (22.319999999999993, -96.6)
        , MV (21.689999999999998, -99.03)
        , MV (20.939999999999998, -101.43)
        , MV (20.130000000000024, -103.83)
        , MV (19.19999999999999, -106.16999999999999)
        , MV (18.20999999999998, -108.48)
        , MV (17.130000000000024, -110.73)
        , MV (15.960000000000008, -112.98)
        , MV (14.730000000000018, -115.17)
        , MV (13.409999999999997, -117.3)
        , MV (12.030000000000001, -119.4)
        , MV (10.560000000000002, -121.44)
        , MV (9.030000000000001, -123.45)
        , MV (7.440000000000026, -125.37)
        , MV (5.759999999999991, -127.25999999999999)
        , MV (4.019999999999982, -129.09)
        , MV (2.219999999999999, -130.83)
        , MV (0.38999999999998636, -132.54)
        , MV (-1.5300000000000011, -134.16)
        , MV (-3.509999999999991, -135.75)
        , MV (-5.52000000000001, -137.22)
        , MV (-7.590000000000003, -138.66)
        , MV (-9.719999999999999, -139.98)
        , MV (-11.879999999999995, -141.27)
        , MV (-14.099999999999994, -142.44)
        , MV (-16.379999999999995, -143.55)
        , MV (-18.659999999999997, -144.57)
        , MV (-21.0, -145.5)
        , MV (-23.400000000000006, -146.31)
        , MV (-25.80000000000001, -147.06)
        , MV (-28.260000000000005, -147.72)
        , MV (-29.61, -148.05)
        , MV (-30.989999999999995, -148.35)
        , MV (-32.370000000000005, -148.62)
        , MV (-33.75, -148.89)
        , MV (-35.16000000000001, -149.13)
        , MV (-36.540000000000006, -149.34)
        , MV (-37.95, -149.52)
        , MV (-39.36, -149.67)
        , MV (-40.77000000000001, -149.79)
        , MV (-42.18000000000001, -149.88)
        , MV (-43.58999999999999, -149.97)
        , MV (-45.0, -150.0)
        , MV (-46.41, -150.0)
        , MV (-47.81999999999999, -149.97)
        , MV (-49.230000000000004, -149.91)
        , MV (-50.64, -149.79)
        , PU
        , MV (-61.379999999999995, -145.5)
        , PD
        , MV (-62.58, -144.9)
        , MV (-63.72, -144.24)
        , MV (-64.86, -143.52)
        , MV (-65.94, -142.77)
        , MV (-67.02, -141.99)
        , MV (-68.04, -141.15)
        , MV (-69.03, -140.28)
        , MV (-69.99000000000001, -139.38)
        , MV (-70.92, -138.42)
        , MV (-71.82000000000001, -137.43)
        , MV (-72.66000000000001, -136.44)
        , MV (-73.47, -135.39)
        , MV (-74.25, -134.31)
        , MV (-74.97, -133.23)
        , MV (-75.69, -132.09)
        , MV (-76.32, -130.95)
        , MV (-76.92, -129.78)
        , MV (-77.49, -128.57999999999998)
        , MV (-78.03, -127.35)
        , MV (-78.48, -126.12)
        , MV (-78.93, -124.89)
        , MV (-79.29, -123.6)
        , MV (-79.62, -122.34)
        , MV (-79.92, -121.05)
        , MV (-80.13, -119.73)
        , MV (-80.31, -118.44)
        , MV (-80.46, -117.12)
        , MV (-80.52, -115.8)
        , MV (-80.55, -114.45)
        , MV (-80.52, -113.13)
        , MV (-80.43, -111.81)
        , MV (-80.31, -110.46000000000001)
        , MV (-80.13, -108.93)
        , MV (-79.86, -107.37)
        , MV (-79.53, -105.87)
        , MV (-79.14, -104.37)
        , MV (-78.66, -102.9)
        , MV (-78.12, -101.46000000000001)
        , MV (-77.49, -100.05)
        , MV (-76.83, -98.64)
        , MV (-76.08, -97.28999999999999)
        , MV (-75.27000000000001, -95.97)
        , MV (-74.42999999999999, -94.71000000000001)
        , MV (-73.5, -93.45)
        , MV (-72.54, -92.25)
        , MV (-71.52, -91.11)
        , MV (-70.44, -89.97)
        , MV (-69.33000000000001, -88.92)
        , MV (-68.19, -87.9)
        , MV (-66.99, -86.91)
        , MV (-65.73, -86.01)
        , MV (-64.44, -85.14)
        , MV (-63.150000000000006, -84.33)
        , MV (-61.80000000000001, -83.58)
        , MV (-60.42, -82.89)
        , MV (-59.00999999999999, -82.26)
        , MV (-57.57000000000001, -81.69)
        , MV (-56.099999999999994, -81.18)
        , MV (-54.599999999999994, -80.76)
        , MV (-53.099999999999994, -80.39999999999999)
        , MV (-51.599999999999994, -80.1)
        , MV (-50.040000000000006, -79.86)
        , MV (-48.510000000000005, -79.74000000000001)
        , MV (-46.94999999999999, -79.65)
        , MV (-45.63000000000001, -79.68)
        , MV (-44.31, -79.65)
        , MV (-43.02000000000001, -79.56)
        , MV (-41.730000000000004, -79.41)
        , MV (-40.44, -79.2)
        , MV (-39.150000000000006, -78.96)
        , MV (-37.89, -78.69)
        , MV (-36.629999999999995, -78.36)
        , MV (-35.370000000000005, -77.97)
        , MV (-34.14, -77.52)
        , MV (-32.94, -77.07)
        , MV (-31.739999999999995, -76.53)
        , MV (-30.569999999999993, -75.99)
        , MV (-29.39999999999999, -75.39)
        , MV (-28.289999999999992, -74.72999999999999)
        , MV (-27.180000000000007, -74.04)
        , MV (-26.10000000000001, -73.32000000000001)
        , MV (-25.05000000000001, -72.57000000000001)
        , MV (-24.0, -71.76)
        , MV (-23.00999999999999, -70.92)
        , MV (-22.049999999999997, -70.05)
        , MV (-21.150000000000006, -69.12)
        , MV (-20.25, -68.19)
        , MV (-19.379999999999995, -67.19999999999999)
        , MV (-18.569999999999993, -66.21000000000001)
        , MV (-17.789999999999992, -65.16)
        , MV (-17.069999999999993, -64.08)
        , MV (-16.379999999999995, -62.97)
        , MV (-15.719999999999999, -61.83)
        , MV (-15.120000000000005, -60.69)
        , MV (-14.579999999999984, -59.489999999999995)
        , MV (-14.069999999999993, -58.25999999999999)
        , MV (-13.530000000000001, -56.91)
        , MV (-13.080000000000013, -55.53)
        , MV (-12.659999999999997, -54.14999999999999)
        , MV (-12.330000000000013, -52.74000000000001)
        , MV (-12.030000000000001, -51.33)
        , MV (-11.819999999999993, -49.89)
        , MV (-11.669999999999987, -48.44999999999999)
        , MV (-11.580000000000013, -47.010000000000005)
        , MV (-11.549999999999983, -45.56999999999999)
        , MV (-11.580000000000013, -44.129999999999995)
        , MV (-11.669999999999987, -42.69)
        , MV (-11.819999999999993, -41.25)
        , MV (-12.030000000000001, -39.83999999999999)
        , MV (-12.299999999999983, -38.400000000000006)
        , MV (-12.629999999999995, -37.019999999999996)
        , MV (-12.990000000000009, -35.610000000000014)
        , MV (-13.439999999999998, -34.22999999999999)
        , MV (-13.919999999999987, -32.879999999999995)
        , MV (-14.460000000000008, -31.53)
        , MV (-15.060000000000002, -30.210000000000008)
        , MV (-15.719999999999999, -28.94999999999999)
        , MV (-16.409999999999997, -27.659999999999997)
        , MV (-17.159999999999997, -26.459999999999994)
        , MV (-17.97, -25.260000000000005)
        , MV (-18.840000000000003, -24.08999999999999)
        , MV (-19.74000000000001, -22.950000000000003)
        , MV (-20.69999999999999, -21.870000000000005)
        , MV (-21.689999999999998, -20.849999999999994)
        , MV (-22.739999999999995, -19.829999999999984)
        , MV (-23.85000000000001, -18.900000000000006)
        , MV (-24.989999999999995, -18.0)
        , MV (-26.189999999999998, -17.129999999999995)
        , MV (-27.180000000000007, -16.439999999999998)
        , MV (-28.19999999999999, -15.780000000000001)
        , MV (-29.249999999999986, -15.180000000000007)
        , MV (-30.299999999999997, -14.640000000000015)
        , MV (-31.38000000000001, -14.129999999999995)
        , MV (-32.49000000000001, -13.679999999999978)
        , MV (-33.599999999999994, -13.289999999999992)
        , MV (-34.71000000000001, -12.930000000000007)
        , MV (-35.849999999999994, -12.599999999999994)
        , MV (-36.99000000000001, -12.330000000000013)
        , MV (-38.16, -12.090000000000003)
        , MV (-39.3, -11.909999999999997)
        , MV (-40.5, -11.759999999999991)
        , MV (-41.67, -11.610000000000014)
        , MV (-42.870000000000005, -11.52000000000001)
        , MV (-44.03999999999999, -11.490000000000009)
        , MV (-45.239999999999995, -11.460000000000008)
        , MV (-46.44, -11.460000000000008)
        , MV (-47.64, -11.490000000000009)
        , MV (-48.86999999999999, -11.549999999999983)
        , MV (-51.269999999999996, -11.730000000000018)
        , MV (-53.67, -12.0)
        , MV (-56.040000000000006, -12.330000000000013)
        , MV (-58.41, -12.75)
        , MV (-60.72000000000001, -13.199999999999989)
        , MV (-63.03, -13.710000000000008)
        , MV (-65.61, -14.400000000000006)
        , MV (-68.16000000000001, -15.210000000000008)
        , MV (-70.67999999999999, -16.110000000000014)
        , MV (-73.14, -17.129999999999995)
        , MV (-75.57000000000001, -18.24000000000001)
        , MV (-77.94, -19.47)
        , MV (-80.25, -20.789999999999992)
        , MV (-82.53, -22.17)
        , MV (-84.72, -23.67)
        , MV (-86.88, -25.260000000000005)
        , MV (-88.98, -26.909999999999997)
        , MV (-90.99, -28.64999999999999)
        , MV (-92.94, -30.44999999999999)
        , MV (-94.83, -32.34)
        , MV (-96.63, -34.290000000000006)
        , MV (-98.37, -36.33)
        , MV (-100.05, -38.400000000000006)
        , MV (-101.64, -40.56)
        , MV (-103.11, -42.75)
        , MV (-104.55000000000001, -45.03)
        , MV (-105.87, -47.34)
        , MV (-107.1, -49.68000000000001)
        , MV (-108.24000000000001, -52.08)
        , MV (-109.29, -54.540000000000006)
        , MV (-110.25, -57.03)
        , MV (-111.12, -59.55)
        , MV (-111.87, -62.10000000000001)
        , MV (-112.5, -64.71000000000001)
        , MV (-113.03999999999999, -67.32)
        , MV (-113.49000000000001, -69.96000000000001)
        , MV (-113.78999999999999, -72.6)
        , MV (-114.0, -75.3)
        , MV (-114.15, -77.7)
        , MV (-114.21000000000001, -80.13)
        , MV (-114.15, -82.56)
        , MV (-114.03, -84.96000000000001)
        , MV (-113.78999999999999, -87.36)
        , MV (-113.49000000000001, -89.75999999999999)
        , MV (-113.1, -92.13)
        , MV (-112.59, -94.5)
        , MV (-112.05, -96.84)
        , MV (-111.39, -99.15)
        , MV (-110.63999999999999, -101.46000000000001)
        , MV (-109.83000000000001, -103.74000000000001)
        , MV (-108.96000000000001, -105.96)
        , MV (-107.97, -108.18)
        , MV (-106.95, -110.34)
        , MV (-105.81, -112.5)
        , MV (-104.64, -114.6)
        , MV (-103.38, -116.64)
        , MV (-102.03, -118.65)
        , MV (-100.65, -120.63)
        , MV (-99.18, -122.55)
        , MV (-97.65, -124.41)
        , MV (-96.06, -126.21000000000001)
        , MV (-94.41, -127.95)
        , MV (-92.67, -129.66)
        , MV (-90.9, -131.28)
        , MV (-89.07, -132.84)
        , MV (-87.15, -134.34)
        , MV (-85.2, -135.75)
        , MV (-83.22, -137.13)
        , MV (-81.14999999999999, -138.39)
        , MV (-79.05, -139.59)
        , MV (-77.94, -140.19)
        , MV (-76.8, -140.76)
        , MV (-75.6, -141.36)
        , MV (-74.4, -141.93)
        , MV (-73.14, -142.5)
        , MV (-71.88, -143.07)
        , MV (-70.62, -143.58)
        , MV (-69.33000000000001, -144.09)
        , MV (-68.07, -144.57)
        , MV (-66.81, -144.99)
        , MV (-65.55000000000001, -145.38)
        , MV (-64.95, -145.53)
        , MV (-64.35000000000001, -145.68)
        , MV (-63.75, -145.83)
        , MV (-63.150000000000006, -145.95)
        , MV (-62.58, -146.07)
        , MV (-62.03999999999999, -146.16)
        , MV (-61.47000000000001, -146.25)
        , MV (-60.93000000000001, -146.28)
        , MV (-60.42, -146.34)
        , MV (-59.91, -146.34)
        , MV (-60.50999999999999, -145.98)
        , MV (-61.379999999999995, -145.5)
        , PU
        , MV (-47.760000000000005, -53.790000000000006)
        , PD
        , MV (-48.09, -53.72999999999999)
        , MV (-48.39, -53.64)
        , MV (-48.72, -53.55)
        , MV (-49.019999999999996, -53.42999999999999)
        , MV (-49.31999999999999, -53.31)
        , MV (-49.59, -53.19)
        , MV (-49.89, -53.040000000000006)
        , MV (-50.16000000000001, -52.89)
        , MV (-50.43000000000001, -52.74000000000001)
        , MV (-50.67, -52.56)
        , MV (-50.94, -52.379999999999995)
        , MV (-51.17999999999999, -52.17)
        , MV (-51.42, -51.99000000000001)
        , MV (-51.629999999999995, -51.77999999999999)
        , MV (-52.08, -51.33)
        , MV (-52.47, -50.849999999999994)
        , MV (-52.83, -50.34)
        , MV (-53.16000000000001, -49.83000000000001)
        , MV (-53.42999999999999, -49.290000000000006)
        , MV (-53.7, -48.72)
        , MV (-53.91000000000001, -48.11999999999999)
        , MV (-54.09, -47.55)
        , MV (-54.24000000000001, -46.92)
        , MV (-54.33, -46.31999999999999)
        , MV (-54.39, -45.69)
        , MV (-54.42, -45.09)
        , MV (-54.42, -44.459999999999994)
        , MV (-54.360000000000014, -43.86)
        , MV (-54.24000000000001, -43.230000000000004)
        , MV (-54.120000000000005, -42.629999999999995)
        , MV (-53.94, -42.06)
        , MV (-53.7, -41.489999999999995)
        , MV (-53.58, -41.19)
        , MV (-53.42999999999999, -40.92)
        , MV (-53.28, -40.650000000000006)
        , MV (-53.129999999999995, -40.41)
        , MV (-52.95, -40.139999999999986)
        , MV (-52.769999999999996, -39.900000000000006)
        , MV (-52.56, -39.629999999999995)
        , MV (-52.349999999999994, -39.389999999999986)
        , MV (-52.14, -39.17999999999999)
        , MV (-51.89999999999999, -38.94000000000001)
        , MV (-51.66000000000001, -38.730000000000004)
        , MV (-51.39, -38.52000000000001)
        , MV (-51.14999999999999, -38.34)
        , MV (-50.849999999999994, -38.129999999999995)
        , MV (-50.55, -37.92)
        , MV (-50.25, -37.709999999999994)
        , MV (-49.94999999999999, -37.53)
        , MV (-49.64999999999999, -37.349999999999994)
        , MV (-49.349999999999994, -37.2)
        , MV (-49.019999999999996, -37.08)
        , MV (-48.69, -36.959999999999994)
        , MV (-48.39, -36.84)
        , MV (-48.06, -36.75)
        , MV (-47.730000000000004, -36.66)
        , MV (-47.39999999999999, -36.599999999999994)
        , MV (-47.06999999999999, -36.540000000000006)
        , MV (-46.739999999999995, -36.50999999999999)
        , MV (-46.41, -36.47999999999999)
        , MV (-46.08, -36.47999999999999)
        , MV (-45.750000000000014, -36.47999999999999)
        , MV (-45.41999999999999, -36.50999999999999)
        , MV (-45.09, -36.540000000000006)
        , MV (-44.760000000000005, -36.57000000000001)
        , MV (-44.459999999999994, -36.629999999999995)
        , MV (-43.80000000000001, -36.78)
        , MV (-43.16999999999999, -36.959999999999994)
        , MV (-42.53999999999999, -37.2)
        , MV (-41.94, -37.47)
        , MV (-41.370000000000005, -37.8)
        , MV (-40.8, -38.16)
        , MV (-40.25999999999999, -38.55)
        , MV (-39.78, -38.97)
        , MV (-39.3, -39.45)
        , MV (-38.849999999999994, -39.92999999999999)
        , MV (-38.459999999999994, -40.47)
        , MV (-38.25, -40.739999999999995)
        , MV (-38.07000000000001, -41.00999999999999)
        , MV (-37.92, -41.28)
        , MV (-37.77000000000001, -41.58)
        , MV (-37.620000000000005, -41.879999999999995)
        , MV (-37.5, -42.18000000000001)
        , MV (-37.379999999999995, -42.480000000000004)
        , MV (-37.25999999999999, -42.81)
        , MV (-37.17, -43.11)
        , MV (-37.08, -43.44)
        , MV (-37.019999999999996, -43.769999999999996)
        , MV (-36.959999999999994, -44.10000000000001)
        , MV (-36.92999999999999, -44.43000000000001)
        , MV (-36.900000000000006, -44.78999999999999)
        , MV (-36.900000000000006, -45.11999999999999)
        , MV (-36.900000000000006, -45.45)
        , MV (-36.92999999999999, -45.81)
        , MV (-36.959999999999994, -46.16999999999999)
        , MV (-37.019999999999996, -46.53)
        , MV (-37.08, -46.86)
        , MV (-37.17, -47.22)
        , MV (-37.290000000000006, -47.58000000000001)
        , MV (-37.41, -47.999999999999986)
        , MV (-37.53, -48.39)
        , MV (-37.67999999999999, -48.78)
        , MV (-37.86, -49.17)
        , MV (-38.07000000000001, -49.53)
        , MV (-38.28, -49.89)
        , MV (-38.52000000000001, -50.25)
        , MV (-38.75999999999999, -50.58000000000001)
        , MV (-39.03, -50.91000000000001)
        , MV (-39.33, -51.21000000000001)
        , MV (-39.60000000000001, -51.47999999999999)
        , MV (-39.92999999999999, -51.77999999999999)
        , MV (-40.230000000000004, -52.05)
        , MV (-40.58999999999999, -52.290000000000006)
        , MV (-40.92, -52.52999999999999)
        , MV (-41.28, -52.74000000000001)
        , MV (-41.64, -52.95)
        , MV (-42.0, -53.129999999999995)
        , MV (-42.39, -53.31)
        , MV (-42.78, -53.46000000000001)
        , MV (-43.16999999999999, -53.58)
        , MV (-43.58999999999999, -53.7)
        , MV (-43.980000000000004, -53.790000000000006)
        , MV (-44.400000000000006, -53.879999999999995)
        , MV (-44.81999999999999, -53.94)
        , MV (-45.239999999999995, -53.97)
        , MV (-45.66, -54.0)
        , MV (-46.08, -54.0)
        , MV (-46.500000000000014, -53.97)
        , MV (-46.92, -53.94)
        , MV (-47.34, -53.879999999999995)
        , MV (-47.760000000000005, -53.790000000000006)
        , PU
        , MV (-44.22, -122.52)
        , PD
        , MV (-43.80000000000001, -122.46)
        , MV (-43.41, -122.37)
        , MV (-43.05000000000001, -122.28)
        , MV (-42.69, -122.16)
        , MV (-42.33, -122.03999999999999)
        , MV (-42.0, -121.89)
        , MV (-41.67, -121.74)
        , MV (-41.370000000000005, -121.56)
        , MV (-41.07000000000001, -121.38)
        , MV (-40.77000000000001, -121.17)
        , MV (-40.5, -120.96000000000001)
        , MV (-40.230000000000004, -120.72)
        , MV (-39.989999999999995, -120.48)
        , MV (-39.75, -120.24000000000001)
        , MV (-39.50999999999999, -119.97)
        , MV (-39.3, -119.7)
        , MV (-39.09, -119.43)
        , MV (-38.91, -119.13)
        , MV (-38.730000000000004, -118.83)
        , MV (-38.58, -118.53)
        , MV (-38.42999999999999, -118.23)
        , MV (-38.28, -117.9)
        , MV (-38.16, -117.57)
        , MV (-38.040000000000006, -117.24)
        , MV (-37.95, -116.91)
        , MV (-37.86, -116.58)
        , MV (-37.8, -116.22)
        , MV (-37.709999999999994, -115.89)
        , MV (-37.67999999999999, -115.53)
        , MV (-37.650000000000006, -115.17)
        , MV (-37.620000000000005, -114.81)
        , MV (-37.59, -114.47999999999999)
        , MV (-37.59, -114.12)
        , MV (-37.620000000000005, -113.75999999999999)
        , MV (-37.650000000000006, -113.4)
        , MV (-37.67999999999999, -113.07)
        , MV (-37.74000000000001, -112.71000000000001)
        , MV (-37.8, -112.38)
        , MV (-37.86, -112.02000000000001)
        , MV (-37.95, -111.69)
        , MV (-38.07000000000001, -111.36)
        , MV (-38.19000000000001, -111.03)
        , MV (-38.30999999999999, -110.69999999999999)
        , MV (-38.459999999999994, -110.4)
        , MV (-38.61, -110.07)
        , MV (-38.75999999999999, -109.77000000000001)
        , MV (-38.94000000000001, -109.47)
        , MV (-39.150000000000006, -109.19999999999999)
        , MV (-39.33, -108.93)
        , MV (-39.57000000000001, -108.66)
        , MV (-39.78, -108.39)
        , MV (-40.05, -108.15)
        , MV (-40.28999999999999, -107.91)
        , MV (-40.56, -107.7)
        , MV (-40.83, -107.49000000000001)
        , MV (-41.129999999999995, -107.28)
        , MV (-41.459999999999994, -107.1)
        , MV (-41.75999999999999, -106.92)
        , MV (-42.08999999999999, -106.77)
        , MV (-42.45, -106.65)
        , MV (-42.81, -106.53)
        , MV (-43.16999999999999, -106.41)
        , MV (-43.56, -106.32)
        , MV (-43.95, -106.25999999999999)
        , MV (-44.28, -106.16999999999999)
        , MV (-44.61, -106.11)
        , MV (-44.91, -106.08)
        , MV (-45.239999999999995, -106.05000000000001)
        , MV (-45.53999999999999, -106.02)
        , MV (-45.86999999999999, -106.02)
        , MV (-46.16999999999999, -106.02)
        , MV (-46.47, -106.05000000000001)
        , MV (-46.769999999999996, -106.08)
        , MV (-47.06999999999999, -106.11)
        , MV (-47.36999999999999, -106.16999999999999)
        , MV (-47.67, -106.25999999999999)
        , MV (-47.94, -106.32)
        , MV (-48.239999999999995, -106.41)
        , MV (-48.510000000000005, -106.53)
        , MV (-48.78, -106.65)
        , MV (-49.31999999999999, -106.89)
        , MV (-49.83000000000001, -107.19)
        , MV (-50.34, -107.55000000000001)
        , MV (-50.790000000000006, -107.91)
        , MV (-51.24000000000001, -108.3)
        , MV (-51.66000000000001, -108.75)
        , MV (-52.05, -109.19999999999999)
        , MV (-52.41000000000001, -109.68)
        , MV (-52.74000000000001, -110.19)
        , MV (-53.040000000000006, -110.73)
        , MV (-53.31, -111.27000000000001)
        , MV (-53.519999999999996, -111.81)
        , MV (-53.7, -112.38)
        , MV (-53.849999999999994, -112.98)
        , MV (-53.94, -113.55000000000001)
        , MV (-54.0, -114.15)
        , MV (-54.03, -114.45)
        , MV (-54.03, -114.75)
        , MV (-54.0, -115.05)
        , MV (-54.0, -115.35)
        , MV (-53.97, -115.65)
        , MV (-53.91000000000001, -115.94999999999999)
        , MV (-53.849999999999994, -116.25)
        , MV (-53.790000000000006, -116.55)
        , MV (-53.7, -116.85)
        , MV (-53.58, -117.15)
        , MV (-53.49000000000001, -117.42)
        , MV (-53.370000000000005, -117.72)
        , MV (-53.22, -117.99000000000001)
        , MV (-53.07000000000001, -118.28999999999999)
        , MV (-52.89, -118.56)
        , MV (-52.71000000000001, -118.83)
        , MV (-52.56, -119.07)
        , MV (-52.379999999999995, -119.31)
        , MV (-52.17, -119.55)
        , MV (-51.99000000000001, -119.78999999999999)
        , MV (-51.77999999999999, -120.0)
        , MV (-51.56999999999999, -120.21000000000001)
        , MV (-51.33, -120.42)
        , MV (-51.120000000000005, -120.63)
        , MV (-50.879999999999995, -120.84)
        , MV (-50.61, -121.02)
        , MV (-50.370000000000005, -121.23)
        , MV (-50.099999999999994, -121.41)
        , MV (-49.83000000000001, -121.56)
        , MV (-49.56, -121.71000000000001)
        , MV (-49.290000000000006, -121.86)
        , MV (-48.989999999999995, -122.01)
        , MV (-48.72, -122.13)
        , MV (-48.42, -122.25)
        , MV (-48.11999999999999, -122.37)
        , MV (-47.81999999999999, -122.46)
        , MV (-47.519999999999996, -122.55)
        , MV (-47.22, -122.61)
        , MV (-46.92, -122.67)
        , MV (-46.61999999999999, -122.73)
        , MV (-46.31999999999999, -122.73)
        , MV (-46.019999999999996, -122.75999999999999)
        , MV (-45.72, -122.75999999999999)
        , MV (-45.41999999999999, -122.73)
        , MV (-45.11999999999999, -122.7)
        , MV (-44.78999999999999, -122.67)
        , MV (-44.519999999999996, -122.61)
        , MV (-44.22, -122.52)
        , PU
        , MV (-150.0, -150.0)
       ]

hpglToCommands :: [HPGLCommand] -> [Command]
hpglToCommands hpglCommands = hpglToCommands' (0, 0) hpglCommands
  where
    hpglToCommands' prev [] = []
    hpglToCommands' prev (hpglCommand:coms) = (commands ++ hpglToCommands' newPrev coms)
      where
        commands = case hpglCommand of
          PD -> [PenDown]
          PU -> [PenUp]
          MV point -> lineSteps prev point
        newPrev = case hpglCommand of
          MV point -> point
          _ -> prev

commandSequence = hpglToCommands hpgl

lineSteps :: Point -> Point -> [Command]
lineSteps start end = map Move steps
  where
    steps = calculateSteps (point leftSpool) (point rightSpool) start end